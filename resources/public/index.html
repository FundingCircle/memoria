<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="semantic-ui/semantic.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <title>Memoria</title>
  </head>
  <body>
      <script type="text/javascript">
       var clientId = '{{ google-auth-client-id }}';
       var apiKey = '{{ google-auth-api-key }}';
       var scopes = 'https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/userinfo.email';

       function handleClientLoad() {
           gapi.client.setApiKey(apiKey);
           window.setTimeout(checkAuth,1);
       }

       function checkAuth() {
           gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);
       }

       function handleAuthResult(authResult) {
           if (authResult && !authResult.error) {
               makeApiCall();
           }
       }

       function handleAuthClick(event) {
           event.preventDefault();
           gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);
       }

       function makeApiCall() {
           gapi.client.load('plus', 'v1', function() {
               var request = gapi.client.plus.people.get({'userId': 'me'});

               request.execute(function(resp) {
                   memoria.app.auth(resp);
               });
           });
       }
      </script>
    <div id="memoria-container"></div>
    <div id="modal" class="ui long fullscreen modal"></div>
    <div id="edit-modal" class="ui long fullscreen modal"></div>
    <script src="js/jquery.min.js"></script>
    <script src="semantic-ui/semantic.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>
    <script src="js/memoria.js"></script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
    <script>
     memoria.app.init();
    </script>
    </body>
  </html>
